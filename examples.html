<!doctype html>
<html>
	<head>
		<title>FormHelper Examples</title>

		<style>
			.error {
				border: 1px solid #f00;
			}
			.success {
				border: 1px solid #0f0;
			}
			.example {
				margin-bottom: 30px;
			}
		</style>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script src="lib/form-helper.js"></script>
	</head>

	<body>
		<div class="example">
			Example 1: Simple Login Form
			<form class="login-form">
				<input name="email" type="text" value="aaaa" /><br />
				<input name="password" type="password" value="bbbb" /><br />
				<button class="login-button">Login</button>
			</form>
		</div>

		<script>
			$(function() {
				var loginHelper = $('.login-form').FormHelper({
					fields: {
						email: {
							validate: [FormHelper.validations.minLength(4)]
						},
						password: {
							validate: [FormHelper.validations.minLength(4)]
						}
					}
				});

				$('.login-form .login-button').click(function(e) {
					e.preventDefault();
					if (!loginHelper.validate()) return;
					var state = loginHelper.currentState();

					if (state.email !== $('.login-form [name="email"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 2: No Form Needed!
			<div class="login-no-form">
				<input name="email" type="text" value="aaaa" /><br />
				<input name="password" type="password" value="bbbb" /><br />
				<button class="login-button">Login</button>
			</div>
		</div>

		<script>
			$(function() {
				var noFormLoginHelper = $('.login-no-form').FormHelper({
					fields: {
						email: {
							validate: [FormHelper.validations.minLength(4)]
						},
						password: {
							validate: [FormHelper.validations.minLength(4)]
						}
					}
				});

				$('.login-no-form .login-button').click(function(e) {
					e.preventDefault();
					if (!noFormLoginHelper.validate()) return;
					var state = noFormLoginHelper.currentState();

					if (state.email !== $('.login-no-form [name="email"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 3: Custom Signup Form
			<form class="signup-form">
				<div class="field-wrapper">
					<label>Enter your email address</label>
					<input name="email" type="text" value="a@aaa.com" />
				</div>

				<div class="field-wrapper">
					<label>Enter your password</label>
					<input name="password1" type="password" value="aaaa" />
				</div>

				<div class="field-wrapper">
					<label>Confirm your password</label>
					<input name="password2" type="password" value="aaaa" />
				</div>
				
				<button class="signup-button">Create Account</button>
			</form>
		</div>

		<script>
			$(function() {
				var signupHelper = $('.signup-form').FormHelper({
					// The global `onFail` method runs whenever any field fails validation.
					// `this` represents the field.
					onFail: function() {
						$(this).parent().addClass('error');
					},

					// The global `onPass` method runs whenever any field passes validation.
					// `this` represents the field.
					onPass: function() {
						$(this).parent().removeClass('error');
					},

					fields: {
						email: {
							validate: [
								FormHelper.validations.minLength(4),

								// This validation ensures that the email address has an @ symbol in it.
								function(value) {
									return (value.indexOf('@') !== -1);
								}
							]
						},

						password1: {
							validate: [FormHelper.validations.minLength(4)]
						},

						password2: {
							validate: [
								FormHelper.validations.minLength(4),

								// This validation verifies that the passwords match.
								function(value) {
									return (value === $('[name="password1"]').val());
								}
							],

							// When `password2` fails to validate, highlight both password1 and password2 fields.
							onFail: function() {
								$('[name="password1"]').parent().addClass('error');
								$(this).parent().addClass('error');
							},

							// When `password2` validates, remove any highlights on password1 and password2 fields.
							onPass: function() {
								$('[name="password1"]').parent().removeClass('error');
								$(this).parent().removeClass('error');
							}
						}
					}
				});

				$('.signup-form .signup-button').click(function(e) {
					e.preventDefault();
					if (!signupHelper.validate()) return;
					var state = signupHelper.currentState();

					if (state.email !== $('.signup-form [name="email"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					if (state.password1 !== $('.signup-form [name="password1"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					if (state.password2 !== $('.signup-form [name="password2"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 4: Friends Form With Array Values
			<form class="friends-form">
				<label>Enter up to 3 names of your friends.</label><br />
				<input name="friends[]" type="text" value="aaa" /><br />
				<input name="friends[]" type="text" value="bbb" /><br />
				<input name="friends[]" type="text" value="ccc" /><br />
				<button class="friends-button">Login</button>
			</form>
		</div>

		<script>
			$(function() {
				var friendsHelper = $('.friends-form').FormHelper();

				$('.friends-form .friends-button').click(function(e) {
					e.preventDefault();
					var state = friendsHelper.currentState();
					var $friends = $('.friends-form [name="friends[]"]');

					if (!state.friends || state.friends.length !== $friends.length) {
						$(this).parents('.example').addClass('error');
						return;
					}

					var success = true;

					$friends.each(function() {
						var $friend = $(this);
						var found = false;

						for (var i = 0; i < state.friends.length; i++) {
							if (state.friends[i] === $friend.val()) {
								found = true;
								break;
							}
						}

						if (!found) {
							success = false;
							return false;
						}
					});

					if (!success) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 5: Ignoring Form Fields
			<form class="ignored-form">
				<input class="ignored" name="ignored1" type="hidden" value="test ignore 1" />
				<input class="ignored" name="ignored2" type="hidden" value="test ignore 2" />
				<label>City</label> <input name="city" value="Walnut Creek" /><br />
				<label>State</label> <input name="state" value="CA" /><br />
				<label>Country</label> <input name="country" value="USA" /><br />
				<button class="ignored-button">Test</button>
			</form>
		</div>

		<script>
			$(function() {
				var ignoredHelper = $('.ignored-form').FormHelper({
					ignored: [
						{ selector: '.ignored' },
						'country'
					]
				});

				$('.ignored-form .ignored-button').click(function(e) {
					e.preventDefault();
					var state = ignoredHelper.currentState();

					if (state.ignored1 || state.ignored2 || state.country) {
						$(this).parents('.example').addClass('error');
						return;
					}

					if (state.city !== $('.ignored-form [name="city"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					if (state.state !== $('.ignored-form [name="state"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 6: State Only Includes Configured Fields
			<form class="only-included-form">
				<input name="city" type="text" value="aaaa" /><br />
				<input name="state" type="text" value="bbbb" /><br />
				<button class="only-included-button">Test</button>
			</form>
		</div>

		<script>
			$(function() {
				var onlyIncludedHelper = $('.only-included-form').FormHelper({
					explicitState: true,

					fields: {
						city: {}
					}
				});

				$('.only-included-form .only-included-button').click(function(e) {
					e.preventDefault();
					var state = onlyIncludedHelper.currentState();
					
					if (state.state || state.city !== $('.only-included-form [name="city"]').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 7: Use Selectors Instead of Field Names
			<form class="selector-form">
				<input name="city" type="hidden" value="Laurys Station" />
				<label>City</label><br />
				<input class="city" type="text" value="Walnut Creek" /><br />
				<label>State</label><br />
				<input class="state" type="text" value="CA" /><br />
				<button class="selector-button">Test</button>
			</form>
		</div>

		<script>
			$(function() {
				var selectorFormHelper = $('.selector-form').FormHelper({
					fields: {
						city: {
							selector: '.city',
							validate: [FormHelper.validations.notEmpty()]
						},
						state: {
							selector: '.state',
							validate: [FormHelper.validations.notEmpty()]
						}
					}
				});

				$('.selector-form .selector-button').click(function(e) {
					e.preventDefault();
					if (!selectorFormHelper.validate()) return;
					var state = selectorFormHelper.currentState();
					
					if (state.city !== $('.selector-form .city').val() ||
							state.state !== $('.selector-form .state').val()) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 8: Use Selectors for Field Arrays
			<form class="selector-array-form">
				<label>Enter up to 3 names of your friends.</label><br />
				<input class="friend" type="text" value="aaa" /><br />
				<input class="friend" type="text" value="bbb" /><br />
				<input class="friend" type="text" value="ccc" /><br />
				<button class="friends-button">Login</button>
			</form>
		</div>

		<script>
			$(function() {
				var selectorArrayHelper = $('.selector-array-form').FormHelper({
					fields: {
						friends: {
							selector: '.friend',
							validate: [FormHelper.validations.notEmpty()]
						}
					}
				});

				$('.selector-array-form .friends-button').click(function(e) {
					e.preventDefault();
					if (!selectorArrayHelper.validate()) return;
					var state = selectorArrayHelper.currentState();
					var $friends = $('.selector-array-form .friend');

					if (!state.friends || state.friends.length !== $friends.length) {
						$(this).parents('.example').addClass('error');
						return;
					}

					var success = true;

					$friends.each(function() {
						var $friend = $(this);
						var found = false;

						for (var i = 0; i < state.friends.length; i++) {
							if (state.friends[i] === $friend.val()) {
								found = true;
								break;
							}
						}

						if (!found) {
							success = false;
							return false;
						}
					});

					if (!success) {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>

		<div class="example">
			Example 9: Custom State Retrieval
			<div class="custom-state">
				<span class="title">This is my title</span>
				
				<div class="notes">
					<span data-id="1">Note 1</span><br />
					<span data-id="2">Note 2</span>
				</div>

				<button>Test</button>
			</div>
		</div>

		<script>
			$(function() {
				var customStateHelper = $('.custom-state').FormHelper({
					fields: {
						title: {
							selector: '.title',
							state: function($elem) {
								return $elem.text();
							},
							validate: [FormHelper.validations.minLength(5)]
						},
						notes: {
							selector: '.notes',
							state: function($elem) {
								return $elem.children('span').map(function() {
									var $this = $(this);
									
									return {
										id: $this.attr('data-id'),
										note: $this.text()
									};
								}).get();
							},
							validate: [FormHelper.validations.notEmpty()]
						}
					}
				});

				$('.custom-state button').click(function(e) {
					e.preventDefault();
					if (!customStateHelper.validate()) return;
					var state = customStateHelper.currentState();

					if (state.title !== 'This is my title' ||
							state.notes.length !== 2 ||
							state.notes[0].id !== '1' ||
							state.notes[0].note !== 'Note 1') {
						$(this).parents('.example').addClass('error');
						return;
					}

					$(this).parents('.example').removeClass('error').addClass('success');
				});
			});
		</script>
	</body>
</html>